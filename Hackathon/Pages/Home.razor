@page "/"
@using ClassLibrary.Db
@using Microsoft.EntityFrameworkCore
@using MySqlConnector
@using MySql.Data.MySqlClient
@inject IDbContextFactory<TeamDbContext> _db

<h1>Hello, world!</h1>

<ul>
@foreach (var user in users)
    {
        <li>@user.name</li>
    }
</ul>

@code{
    List<User> users = new List<User>();
    protected override async Task OnInitializedAsync() 
    {
        try
        {
            using var dbContext = _db.CreateDbContext();
            users = await dbContext.Users.ToListAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }
}
